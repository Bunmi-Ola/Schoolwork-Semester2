
--1
Update DEDUCTIONS set INCOMETAX = '0' 
WHERE EMPID = ANY (SELECT EMPID FROM EMPLOYEE WHERE  INCOMETAX = 'N');

rollback;

--2
select EMPLOYEE.LASTNAME, (JOB.PAYRATE*1.05) as "PayRate Increase"
From EMPLOYEE INNER JOIN JOB ON JOB.JOBCODE = EMPLOYEE.JOBCODE
WHERE EMPID = ANY (SELECT EMPID FROM TIMESHEET WHERE (REGHOURS+OTIMEHOURS)> 40 and PAYWEEKENDDATE = 30-MAY-03);


SELECT EMPLOYEE.LASTNAME, EMPLOYEE.FIRSTNAME, EMPLOYEE.CITY
From EMPLOYEE INNER JOIN JOB ON JOB.JOBCODE = EMPLOYEE.JOBCODE
WHERE DESCRIPTION = 'Cashier'; 

--3 (still checking this 3 as nothing came out
select EMPLOYEE.EMPID, EMPLOYEE.LASTNAME, (JOB.PAYRATE*1.05) as "PayRate Increase"
From EMPLOYEE INNER JOIN JOB ON EMPLOYEE.JOBCODE = JOB.JOBCODE 
WHERE EMPID in(SELECT EMPID FROM TIMESHEET Group by EMPID having sum (REGHOURS+OTIMEHOURS )>= '80' );
--1
Update DEDUCTIONS set INCOMETAX = '0' 
WHERE EMPID in (SELECT EMPID FROM EMPLOYEE WHERE  INCOMETAX = 'N');

rollback;

--2
select EMPLOYEE.LASTNAME, (JOB.PAYRATE*1.05) as "PayRate Increase"
From EMPLOYEE, JOB
WHERE EMPLOYEE.JOBCODE = JOB.JOBCODE 
and EMPID in(SELECT EMPID FROM TIMESHEET WHERE (REGHOURS+OTIMEHOURS)> '40' and PAYWEEKENDDATE = '30-MAY-03');

--3 (still checking this 3 as nothing came out
select EMPLOYEE.EMPID, EMPLOYEE.LASTNAME, (JOB.PAYRATE*1.05) as "PayRate Increase"
From EMPLOYEE INNER JOIN JOB ON EMPLOYEE.JOBCODE = JOB.JOBCODE 
WHERE EMPID in(SELECT EMPID FROM TIMESHEET WHERE (REGHOURS+OTIMEHOURS )> '80' Group by EMPID);



--4
select Job.DESCRIPTION
From EMPLOYEE, JOB
WHERE EMPLOYEE.JOBCODE = JOB.JOBCODE 
and EMPID in (SELECT EMPID FROM DEDUCTIONS WHERE (INCOMETAX)> '100');

--5
SELECT EMPLOYEE.LASTNAME ||' '|| EMPLOYEE.FIRSTNAME as "Full Name" From EMPLOYEE
WHERE EMPID not in(SELECT EMPID FROM TIMESHEET);

--6 
select Job.JOBCODE FROM JOB
UNION all
SELECT EMPLOYEE.EMPID FROM EMPLOYEE;

-- it is called jobcode 
-- The columns have similar data types and also in the same order

--7
SELECT RTRIM(TO_CHAR(PAYWEEKENDDATE, 'Day'))||' ' || RTRIM(TO_CHAR(PAYWEEKENDDATE, 'dd')) ||' '|| 
RTRIM(TO_CHAR(PAYWEEKENDDATE, 'Month')) ||' '||RTRIM(TO_CHAR(PAYWEEKENDDATE, 'yyyy')) as "payweekenddate" FROM TIMESHEET
UNION
SELECT RTRIM(TO_CHAR(PAYWEEKENDDATE, 'Day'))||' ' || RTRIM(TO_CHAR(PAYWEEKENDDATE, 'dd')) ||' '|| 
RTRIM(TO_CHAR(PAYWEEKENDDATE, 'Month')) ||' '||RTRIM(TO_CHAR(PAYWEEKENDDATE, 'yyyy')) FROM DEDUCTIONS
UNION
SELECT RTRIM(TO_CHAR(PAYWEEKENDDATE, 'Day'))||' ' || RTRIM(TO_CHAR(PAYWEEKENDDATE, 'dd')) ||' '|| 
RTRIM(TO_CHAR(PAYWEEKENDDATE, 'Month')) ||' '||RTRIM(TO_CHAR(PAYWEEKENDDATE, 'yyyy')) FROM EARNINGS;

--8
select EMPID from EMPLOYEE MINUS select EMPID from EARNINGS;

--9
select JOBCODE from Job MINUS select JOBCODE from EMPLOYEE;

--10
select EMPLOYEE.EMPID, (EARNINGS.REGEARNINGS+EARNINGS.OTIMEEARNINGS) as "Total Pretax Earnings"
From EMPLOYEE, EARNINGS
WHERE EMPLOYEE.EMPID = EARNINGS.EMPID
and EMPLOYEE.CITY= 'Moose Jaw'
and EARNINGS.PAYWEEKENDDATE= '30-MAY-03'
and ((MONTHS_BETWEEN (CURRENT_DATE, EMPLOYEE.BIRTHDATE))/12) > '6';

--11
select EMPLOYEE.EMPID, (EARNINGS.REGEARNINGS+EARNINGS.OTIMEEARNINGS) as "Total Pretax Earnings"
From EMPLOYEE, EARNINGS
WHERE EMPLOYEE.EMPID = EARNINGS.EMPID
and EMPLOYEE.CITY= 'Moose Jaw'
and (EARNINGS.PAYWEEKENDDATE= '30-MAY-03'
or ((MONTHS_BETWEEN (CURRENT_DATE, EMPLOYEE.BIRTHDATE))/12) > '6');

--12
select Job.JOBCODE FROM JOB
UNION all
SELECT EMPLOYEE.JOBCODE FROM EMPLOYEE;

